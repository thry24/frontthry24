<div class="header-wrapper" *ngIf="!isLoginPage && !isCrmRoute">
  <ion-header>
    <ion-toolbar class="Thry24-toolbar">
      <div class="Thry24-container">
        <a class="logo" href="/">
          <img src="/assets/logo-thry24.jpeg" alt="Logo Thry24" />
          <span>Thry24</span>
        </a>

        <div class="nav nav-centrado">
          <a
            class="dropdown-trigger"
            #triggerInicio
            (mouseenter)="handleHover('inicio', triggerInicio)"
            (click)="toggleDropdown('inicio', triggerInicio)"
            (mouseleave)="startHideMenuTimer()"
            >Inicio</a
          >

          <a
            class="dropdown-trigger"
            #triggerPropiedades
            (mouseenter)="handleHover('propiedades', triggerPropiedades)"
            (click)="toggleDropdown('propiedades', triggerPropiedades)"
            (mouseleave)="startHideMenuTimer()"
            >Propiedades</a
          >

          <ng-container
            *ngIf="isLogged && (rol === 'cliente' || rol === 'propietario')"
          >
            <a
              class="dropdown-trigger"
              #triggerAgente
              (mouseenter)="handleHover('agente', triggerAgente)"
              (click)="toggleDropdown('agente', triggerAgente)"
              (mouseleave)="startHideMenuTimer()"
              >Agente</a
            >
          </ng-container>

          <ng-container *ngIf="isLogged && rol === 'agente'">
            <a
              class="dropdown-trigger"
              #triggerAgente
              (mouseenter)="handleHover('agente', triggerAgente)"
              (click)="toggleDropdown('agente', triggerAgente)"
              (mouseleave)="startHideMenuTimer()"
              >Agente</a
            >
          </ng-container>

          <ng-container
            *ngIf="isLogged && (rol === 'cliente' || rol === 'propietario')"
          >
            <a
              class="dropdown-trigger"
              #triggerInmobiliaria
              (mouseenter)="handleHover('inmobiliaria', triggerInmobiliaria)"
              (click)="toggleDropdown('inmobiliaria', triggerInmobiliaria)"
              (mouseleave)="startHideMenuTimer()"
              >Inmobiliaria</a
            >
          </ng-container>

          <ng-container *ngIf="isLogged && rol === 'inmobiliaria'">
            <a
              class="dropdown-trigger"
              #triggerInmobiliaria
              (mouseenter)="handleHover('inmobiliaria', triggerInmobiliaria)"
              (click)="toggleDropdown('inmobiliaria', triggerInmobiliaria)"
              (mouseleave)="startHideMenuTimer()"
              >Inmobiliaria</a
            >
          </ng-container>
        </div>

        <div class="nav nav-derecha" *ngIf="mostrarSesion">
          <ng-container *ngIf="isLogged; else noSesion">
            <div class="user-session">
              <img
                class="avatar"
                [src]="user?.fotoPerfil || user?.logo || 'assets/img/user.jpg'"
                alt="Usuario"
              />
              <button class="btn-logout" (click)="logout()">
                Cerrar sesión
              </button>
            </div>
          </ng-container>

          <ng-template #noSesion>
            <a class="btn-login" href="/login">Iniciar sesión</a>
          </ng-template>
        </div>
      </div>
    </ion-toolbar>
  </ion-header>

  <div
    class="dropdown-bridge"
    *ngIf="showMenu"
    [style.top.px]="bridgeTop"
    [style.left.px]="dropdownLeft"
    [style.width.px]="bridgeWidth"
    (mouseenter)="cancelHideMenu()"
    (mouseleave)="startHideMenuTimer()"
  ></div>

  <div
    class="dropdown-float-outside"
    *ngIf="showMenu"
    [style.top.px]="dropdownTop"
    [style.left.px]="dropdownLeft"
    (mouseenter)="cancelHideMenu()"
    (mouseleave)="startHideMenuTimer()"
  >
    <ng-container [ngSwitch]="activeMenu">
      <ng-container *ngSwitchCase="'inicio'">
        <a href="/quienes-somos">¿Quiénes somos?</a>
        <a href="/que-es-ai24">¿Qué es Thry24?</a>
        <a href="/servicios">Nuestros Servicios</a>
        <a href="/faqs">FAQs</a>
        <a href="/blog">Blog</a>
        <a href="/#">Private Policy</a>
      </ng-container>

      <ng-container *ngSwitchCase="'propiedades'">
        <div class="submenu-group">
          <div
            class="menu-section-title"
            (click)="toggleSubmenu('habitacional')"
          >
            <span>ÁREA HABITACIONAL</span>
            <span class="arrow-icon" [class.rotate]="areaHabitacionalOpen"
              >›</span
            >
          </div>
          <div *ngIf="areaHabitacionalOpen" class="submenu">
            <a href="/propiedades/habitacional/casa">Casa</a>
            <a href="/propiedades/habitacional/departamento">Departamento</a>
          </div>
        </div>

        <div class="submenu-group">
          <div class="menu-section-title" (click)="toggleSubmenu('comercial')">
            <span>ÁREA COMERCIAL</span>
            <span class="arrow-icon" [class.rotate]="areaComercialOpen">›</span>
          </div>
          <div *ngIf="areaComercialOpen" class="submenu">
            <a href="/propiedades/comercial/locales">Locales</a>
            <a href="/propiedades/comercial/edificios">Edificios</a>
            <a href="/propiedades/comercial/oficinas">Oficinas</a>
            <a href="/propiedades/comercial/bodegas">Bodegas</a>
            <a href="/propiedades/comercial/terrenos">Terrenos</a>
            <a href="/propiedades/comercial/ranchos">Ranchos</a>
          </div>
        </div>

        <a href="/propiedades/busqueda-rentas">Búsqueda de Rentas</a>
        <a href="/propiedades/busqueda-mapas">Búsqueda con Mapas</a>
        <a (click)="navegarProtegido('/propiedades/comparar')"
          >Comparar Propiedades</a
        >
        <a (click)="navegarProtegido('/contacto/agente')"
          >Contacta a un Agente Inmobiliario</a
        >
        <a (click)="navegarProtegido('/favoritos')">Mis Favoritas</a>
        <a (click)="navegarProtegido('/recomendaciones')"
          >Recomendaciones</a>
      </ng-container>

      <ng-container *ngSwitchCase="'agente'">
        <ng-container
          *ngIf="isLogged && (rol === 'cliente' || rol === 'propietario')"
        >
          <a href="/agentes">Agentes</a>
        </ng-container>
        <ng-container *ngIf="isLogged && rol === 'agente'">
          <a href="/agente/agregar">Agregar Propiedad</a>
          <a href="/agente/mis-publicaciones">Mis propiedades</a>
          <a (click)="verificarAccesoCRM()">CRM</a>
        </ng-container>
      </ng-container>

      <ng-container *ngSwitchCase="'inmobiliaria'">
        <ng-container
          *ngIf="isLogged && (rol === 'cliente' || rol === 'propietario')"
        >
          <a href="/directorio/inmobiliarias">Directorio Inmobiliarias</a>
        </ng-container>
        <ng-container *ngIf="isLogged && rol === 'inmobiliaria'">
          <a href="/requerimientos/">Publicar Requerimiento</a>
        </ng-container>
      </ng-container>
    </ng-container>
  </div>
</div>

<div class="header-wrapper" *ngIf="isLoginPage">
  <ion-header>
    <ion-toolbar class="Thry24-toolbar">
      <div class="Thry24-container">
        <a class="logo" href="/">
          <img src="/assets/logo-thry24.jpeg" alt="Logo Thry24" />
          <span>Thry24</span>
        </a>
      </div>
    </ion-toolbar>
  </ion-header>
</div>
